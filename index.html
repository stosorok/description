<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <title>–û–ø–∏—Å 1.1</title>

  <!-- =======================
       –ó–ê–ú–Ü–ù–ò icon.png –ù–ê –°–í–Ü–ô –§–ê–ô–õ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
       =======================
       <link rel="apple-touch-icon" href="icon.png" />
  -->
  <link rel="apple-touch-icon" href="icon.png" />

  <style>
    :root{
      --green: #48d597;
      --violet: #b6a9f7;
      --fg: #222;
      --page-bg: #eeeeee;
      --card-bg: #fff;
      --gap: 10px;
    }

    html,body{height:100%;margin:0;padding:10px;background:var(--page-bg);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;color:var(--fg);}
    h1{ text-align:center;margin:6px 0 12px;font-size:20px;font-weight:800; }

    label.section{display:block;font-weight:700;margin-bottom:6px;}
    .form-section{margin-bottom:12px;}

    input[type="text"], input[type="number"], textarea{
      box-sizing:border-box;padding:8px;border-radius:6px;border:1px solid #ccc;font-size:15px;width:100%;
      background:var(--card-bg); color:var(--fg);
    }

    input[type="checkbox"]{ accent-color: var(--green); }
    input[type="radio"]{ accent-color: var(--violet); }

    .radio-group, .size-group, .materials, .category-group, .actions { display:flex; flex-wrap:wrap; gap:8px; align-items:center; }

    .size-group label, .radio-group label, .materials label { display:flex; align-items:center; gap:6px; cursor:pointer; font-weight:500; }
    .category-pill { background:var(--violet); color:#fff; padding:6px 10px; border-radius:8px; cursor:pointer; font-weight:700; user-select:none; }
    .category-pill.active { background:var(--green); }

    /* –ö–∞—Ç–µ–≥–æ—Ä—ñ—è: –∫–æ–∂–µ–Ω —Ä—è–¥–æ–∫ label + input –≤ –æ–¥–∏–Ω —Ä—è–¥ */
    .cat-fields{margin-top:8px; display:flex; flex-direction:column; gap:8px;}
    .cat-row{display:flex; gap:12px; align-items:center;}
    .cat-row label{width:120px; font-weight:600;}
    .cat-row input{flex:1; padding:7px;}

    /* –∑–º–µ–Ω—à–µ–º–æ –≤—ñ–¥—Å—Ç—É–ø–∏ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö */
    @media (max-width:420px){
      .cat-row label{width:95px;}
    }

    /* MATERIALS 2 rows wrap */
    .materials{gap:8px;}

    /* –î—ñ—ó */
    .actions{margin-top:8px; gap:10px;}
    .btn{flex:1;padding:10px;border-radius:8px;border:0;color:#fff;font-weight:800;cursor:pointer;font-size:15px;}
    .btn.generate{background:var(--green);}
    .btn.copy{background:var(--violet);}
    .btn.save{background:#414141;}

    /* Output textarea - –∞–≤—Ç–æ–ø—ñ–¥–≥–æ–Ω–∫–∞ –≤–∏—Å–æ—Ç–∏ —á–µ—Ä–µ–∑ JS */
    #output{ min-height:160px; max-height:60vh; overflow:hidden; margin-top:12px; border-radius:8px; }

    /* Saved list (–∞–∫–æ—Ä–¥–µ–æ–Ω–∏) */
    #savedList{ margin-top:12px; display:flex; flex-direction:column; gap:8px; }
    .saved-item{ background:#fff; border-radius:8px; padding:8px; box-shadow:0 2px 6px rgba(0,0,0,0.06); }
    .saved-header{ display:flex; align-items:center; justify-content:space-between; gap:8px; cursor:pointer; user-select:none; padding:4px 2px; }
    .saved-title{ font-weight:700; }
    .saved-controls{ display:flex; gap:8px; }
    .icon-btn{ width:36px; height:36px; border-radius:8px; background:transparent; border:0; display:inline-flex; align-items:center; justify-content:center; cursor:pointer; }
    .icon-btn svg{ width:18px; height:18px; fill:var(--fg); }

    .saved-body{ display:none; white-space:pre-line; margin-top:8px; color:#222; font-size:14px; }

    /* CLEAR FAB */
    .clear-fab{ position:fixed; right:14px; bottom:14px; width:46px; height:46px; border-radius:10px; background:#222; display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:999; }
    .clear-fab svg{ width:22px; height:22px; fill:#fff; }

    /* SPLASH */
    #splash{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; flex-direction:column; z-index:10000; background: linear-gradient(135deg,#fc00ff 0%,#00dbde 100%); color:#fff; transition:opacity .45s ease; }
    #splash .icon{ width:72px; height:72px; margin-bottom:12px; }
    #splash h2{ margin:0; font-size:26px; font-weight:800; }
    #splash .ver{ position:absolute; bottom:18px; font-size:13px; opacity:0.95; }

    /* AUTOCOMPLETE dropdown */
    .autocomplete-wrap{ position:relative; }
    .suggestions{ position:absolute; left:0; right:0; background:#fff; border:1px solid #ccc; border-top:none; z-index:30; max-height:200px; overflow:auto; border-radius:0 0 8px 8px; box-shadow:0 6px 18px rgba(0,0,0,0.08); }
    .suggestion{ padding:8px 10px; cursor:pointer; }
    .suggestion:hover, .suggestion.active{ background:#f3f3f3; }
  </style>
</head>
<body>
  <!-- ===== SPLASH SCREEN =====
       - –©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ —ñ–∫–æ–Ω–∫—É —Å–ø–ª–µ—à—É, –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π SVG —É div.icon –Ω–∏–∂—á–µ.
       - –©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç, –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π CSS background —É #splash.
       - –©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –≤–µ—Ä—Å—ñ—é, –∑–º—ñ–Ω—é–π –∑–º—ñ–Ω–Ω—É APP_VERSION —É —Å–∫—Ä–∏–ø—Ç—ñ (—ñ –≤–æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ—Ç—è–≥–Ω–µ—Ç—å—Å—è —Å—é–¥–∏).
  -->
  <div id="splash" role="dialog" aria-hidden="false">
    <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <!-- –ó–∞–º—ñ–Ω–∏—Ç–∏ —Ç—É—Ç SVG-—ñ–∫–æ–Ω–∫—É, —è–∫—â–æ —Ç—Ä–µ–±–∞ -->
      <path d="m21.72 10.13-2.29 2.3c-.39.39-1.03.39-1.42 0l-.01-.02V18c0 1.65-1.35 3-3 3H9c-1.65 0-3-1.35-3-3v-5.59l-.01.02c-.39.39-1.03.39-1.42 0l-2.29-2.3c-.78-.78-.78-2.04 0-2.82l4.01-4.02C6.48 3.11 6.73 3 7 3h2c.31 0 .61.15.8.4.52.7 1.33 1.1 2.2 1.1s1.68-.4 2.2-1.1c.19-.25.49-.4.8-.4h2c.27 0 .52.11.71.29l4.01 4.02c.78.78.78 2.04 0 2.82z" fill="#ffffff" opacity="1" data-original="#000000" class=""></path>
    </svg>
    <h2>–û–ø–∏—Å</h2>
    <div class="ver">–≤–µ—Ä—Å—ñ—è <span id="appVersion">1.1</span></div>
  </div>

  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <h1>–û–ø–∏—Å 1.1</h1>

  <!-- –§–û–†–ú–ê -->
  <div class="form-section">
    <label class="section" for="price">–¶—ñ–Ω–∞ üí∏</label>
    <input id="price" type="text" placeholder="–í–∫–∞–∂—ñ—Ç—å —Ü—ñ–Ω—É, –Ω–∞–ø—Ä. 450 –≥—Ä–Ω" />
  </div>

  <div class="form-section">
    <label class="section" for="brand">–ë—Ä–µ–Ω–¥</label>
    <div class="autocomplete-wrap">
      <input id="brand" type="text" placeholder="–ü–æ—á–Ω—ñ—Ç—å –≤–≤–æ–¥–∏—Ç–∏ –±—Ä–µ–Ω–¥..." autocomplete="off" />
      <div id="brandSuggestions" class="suggestions" style="display:none;"></div>
    </div>
  </div>

  <div class="form-section">
    <label class="section" for="descInput">–û–ø–∏—Å</label>
    <input id="descInput" type="text" placeholder="–ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å —É 1 —Ä–µ—á–µ–Ω–Ω—ñ" />
  </div>

  <div class="form-section">
    <label class="section">–°—Ç–∞–Ω</label>
    <div class="radio-group">
      <label><input name="condition" type="radio" value="–°—Ç–∞–Ω —á—É–¥–æ–≤–∏–π" checked /> –ß—É–¥–æ–≤–∏–π</label>
      <label><input name="condition" type="radio" value="–°—Ç–∞–Ω –¥—É–∂–µ —Ö–æ—Ä–æ—à–∏–π" /> –î—É–∂–µ —Ö–æ—Ä–æ—à–∏–π</label>
    </div>
  </div>

  <hr />

  <div class="form-section">
    <label class="section">–†–æ–∑–º—ñ—Ä</label>
    <div class="size-group">
      <label><input class="size-chk" type="checkbox" value="XS" /> XS</label>
      <label><input class="size-chk" type="checkbox" value="S" /> S</label>
      <label><input class="size-chk" type="checkbox" value="M" /> M</label>
      <label><input class="size-chk" type="checkbox" value="L" /> L</label>
      <label><input class="size-chk" type="checkbox" value="XL" /> XL</label>
      <label><input class="size-chk" type="checkbox" value="XXL" /> XXL</label>
    </div>
  </div>

  <hr />

  <div class="form-section">
    <label class="section">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
    <div id="categoryGroup" class="category-group">
      <div class="category-pill" data-cat="sweater">–°–≤–µ—Ç—Ä</div>
      <div class="category-pill" data-cat="pants">–®—Ç–∞–Ω–∏</div>
      <div class="category-pill" data-cat="skirt">–°–ø—ñ–¥–Ω–∏—Ü—è</div>
      <div class="category-pill" data-cat="tshirt">–§—É—Ç–±–æ–ª–∫–∞</div>
      <div class="category-pill" data-cat="outerwear">–í–µ—Ä—Ö–Ω—ñ–π –æ–¥—è–≥</div>
    </div>

    <div id="categoryFieldsContainer"></div>
  </div>

  <hr />

  <div class="form-section">
    <label class="section">–ú–∞—Ç–µ—Ä—ñ–∞–ª</label>
    <div class="materials">
      <label><input type="checkbox" value="–±–∞–≤–æ–≤–Ω–∞" /> –ë–∞–≤–æ–≤–Ω–∞</label>
      <label><input type="checkbox" value="–≤—ñ—Å–∫–æ–∑–∞ –µ–ª–∞—Å—Ç–∞–Ω" /> –í—ñ—Å–∫–æ–∑–∞ –ï–ª–∞—Å—Ç–∞–Ω</label>
      <label><input type="checkbox" value="–≤–æ–≤–Ω–∞" /> –í–æ–≤–Ω–∞</label>
      <label><input type="checkbox" value="–∫–∞—à–µ–º—ñ—Ä" /> –ö–∞—à–µ–º—ñ—Ä</label>
      <label><input type="checkbox" value="–Ω–µ–π–ª–æ–Ω" /> –ù–µ–π–ª–æ–Ω</label>
      <label><input type="checkbox" value="–ø–æ–ª—ñ–∞–º—ñ–¥" /> –ü–æ–ª—ñ–∞–º—ñ–¥</label>
      <label><input type="checkbox" value="–∞–∫—Ä–∏–ª" /> –ê–∫—Ä–∏–ª</label>
    </div>
    <div style="margin-top:8px;">
      <input id="materialCustom" type="text" placeholder="–Ü–Ω—à–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª" />
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∏: –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ / –ö–æ–ø—ñ—é–≤–∞—Ç–∏ / –ó–±–µ—Ä–µ–≥—Ç–∏ -->
  <div class="actions">
    <button class="btn generate" onclick="onGenerate()">–ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
    <button class="btn copy" onclick="copyMain()">–ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
    <button class="btn save" onclick="onSave()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
  </div>

  <!-- –ü–æ–ª–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (–∞–≤—Ç–æ–ø—ñ–¥—ñ–≥–Ω–∞–Ω–∞ –≤–∏—Å–æ—Ç–∞) -->
  <textarea id="output" readonly></textarea>

  <!-- –°–ø–∏—Å–æ–∫ –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö (–∞–∫–æ—Ä–¥–µ–æ–Ω–∏) -->
  <div id="savedList"></div>

  <!-- –ü–ª–∞–≤–∞—é—á–∞ –∫–Ω–æ–ø–∫–∞ –û—á–∏—Å—Ç–∏—Ç–∏ -->
  <div class="clear-fab" title="–û—á–∏—Å—Ç–∏—Ç–∏" onclick="clearForm()">
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M3 6h18v2H3V6zm2 3h14l-1.5 12.5a1 1 0 0 1-1 .5H7.5a1 1 0 0 1-1-.5L5 9zm5 2v8h2v-8H10zm4 0v8h2v-8h-2z"/>
    </svg>
  </div>

  <script>
    /**************************************************************************
     * –ö–æ–Ω—Ñ—ñ–≥ (–∑–º—ñ–Ω—é–π –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ)
     * - APP_VERSION: –≤–µ—Ä—Å—ñ—è (–≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —É —Å–ø–ª–µ—à—ñ —ñ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–µ —ñ–Ω–¥–µ)
     * - DELETE_SVG: SVG –¥–ª—è –∫–Ω–æ–ø–∫–∏ '–≤–∏–¥–∞–ª–∏—Ç–∏' (–º–∏ –∑–±–µ—Ä–µ–≥–ª–∏ —Ç–≤—ñ–π SVG ‚Äî –ø—Ä–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–≤ –ø—Ä–æ—Å—Ç–æ —ñ–Ω—à—É —Ä—è–¥–∫–æ–≤—É –∑–º—ñ–Ω–Ω—É)
     **************************************************************************/
    const APP_VERSION = "1.1";
    document.getElementById("appVersion").textContent = APP_VERSION;

    // –Ü–∫–æ–Ω–∫–∞ "–•" —è–∫—É —Ç–∏ –ø–æ–ø—Ä–æ—Å–∏–≤ –∑–±–µ—Ä–µ–≥—Ç–∏ ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –∫–Ω–æ–ø—Ü—ñ –≤–∏–¥–∞–ª–∏—Ç–∏
    // (—è–∫—â–æ —Ö–æ—á–µ—à ‚Äî –∑–∞–º—ñ–Ω–∏ —Ü—é —Ä—è–¥–∫–æ–≤—É –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –Ω–∞ —ñ–Ω—à–∏–π SVG)
    const DELETE_SVG = `<svg fill="#000000" width="18" height="18" viewBox="-3.5 0 19 19" xmlns="http://www.w3.org/2000/svg" class="cf-icon-svg"><path d="M11.383 13.644A1.03 1.03 0 0 1 9.928 15.1L6 11.172 2.072 15.1a1.03 1.03 0 1 1-1.455-1.456l3.928-3.928L.617 5.79a1.03 1.03 0 1 1 1.455-1.456L6 8.261l3.928-3.928a1.03 1.03 0 0 1 1.455 1.456L7.455 9.716z"/></svg>`;

    /**************************************************************************
     * –°–ø–∏—Å–æ–∫ –±—Ä–µ–Ω–¥—ñ–≤ (autocomplete). –ü—Ä–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –¥–æ–¥–∞–≤–∞–π/—Ä–µ–¥–∞–≥—É–π –Ω–∞–∑–≤–∏.
     **************************************************************************/
    const BRANDS = [
      "ZARA","H&M","M&S","George","Primark","F&F","Stradivarius","Bershka","Pull & Bear",
      "COS","Arket","Massimo Dutty","Next","New Look","& Other Stories","Mango","ASOS",
      "Topshop","Monki","Reiss","Autograph","Hugo Boss","Cashmere","Woolmark","Ralph Lauren",
      "Max Mara","Only","C&A"
    ];

    /**************************************************************************
     * SPLASH: –ø–ª–∞–≤–Ω–µ —Ö–æ–≤–∞–Ω–Ω—è + fallback
     **************************************************************************/
    window.addEventListener("load", () => {
      setTimeout(hideSplash, 700);
    });
    setTimeout(() => { if (document.getElementById("splash")) hideSplash(); }, 6000);
    function hideSplash(){
      const s = document.getElementById("splash");
      if (!s) return;
      s.style.opacity = "0";
      setTimeout(()=> s.remove(), 480);
    }

    /**************************************************************************
     * CATEGORY fields rendering
     **************************************************************************/
    const categoryFields = {
      sweater: ["–ø–æ –≥—Ä—É–¥–∏", "–ø–æ –Ω–∏–∑—É", "—Ä—É–∫–∞–≤", "–¥–æ–≤–∂–∏–Ω–∞"],
      pants: ["–ø–æ –ø–æ—è—Å", "–ø–æ —Å—Ç–µ–≥–Ω–∞", "–ø–æ—Å.", "–¥–æ–≤–∂–∏–Ω–∞", "—à–∏—Ä–∏–Ω–∞ –≤–Ω–∏–∑—É"],
      skirt: ["–ø–æ –ø–æ—è—Å", "–ø–æ —Å—Ç–µ–≥–Ω–∞", "–¥–æ–≤–∂–∏–Ω–∞"],
      tshirt: ["–ø–æ –≥—Ä—É–¥–∏", "–ø–æ –Ω–∏–∑—É", "–¥–æ–≤–∂–∏–Ω–∞"],
      outerwear: ["–ø–ª–µ—á—ñ", "–ø–æ –≥—Ä—É–¥–∏", "–ø–æ –Ω–∏–∑—É", "—Ä—É–∫–∞–≤", "–¥–æ–≤–∂–∏–Ω–∞"]
    };

    const categoryGroup = document.getElementById("categoryGroup");
    const catFieldsContainer = document.getElementById("categoryFieldsContainer");
    let activeCategory = null;

    categoryGroup.addEventListener("click", (e)=>{
      const pill = e.target.closest(".category-pill");
      if (!pill) return;
      const cat = pill.dataset.cat;
      // –ø—ñ–¥—Å–≤—ñ—Ç–∏—Ç–∏
      [...categoryGroup.querySelectorAll(".category-pill")].forEach(p => p.classList.remove("active"));
      pill.classList.add("active");
      activeCategory = cat;
      renderCategoryFields(cat);
    });

    function renderCategoryFields(cat){
      catFieldsContainer.innerHTML = "";
      if (!cat || !categoryFields[cat]) return;
      const wrapper = document.createElement("div");
      wrapper.className = "cat-fields";
      categoryFields[cat].forEach(field=>{
        const row = document.createElement("div");
        row.className = "cat-row";
        const lbl = document.createElement("label");
        lbl.textContent = field;
        const inp = document.createElement("input");
        inp.type = "text";
        inp.dataset.field = field;
        inp.placeholder = "";
        row.appendChild(lbl);
        row.appendChild(inp);
        wrapper.appendChild(row);
      });
      // —á–µ–∫–±–æ–∫—Å –¥–ª—è "—Ä—É–∫–∞–≤ –≤—ñ–¥ –≥–æ—Ä–ª–æ–≤–∏–Ω–∏" –æ–∫—Ä–µ–º–æ –ø—ñ–¥ –ø–æ–ª—è–º–∏
      if (cat === "sweater" || cat === "outerwear"){
        const cbRow = document.createElement("div");
        cbRow.className = "from-neck";
        cbRow.innerHTML = `<label><input id="fromNeck" type="checkbox"> –†—É–∫–∞–≤ –≤—ñ–¥ –≥–æ—Ä–ª–æ–≤–∏–Ω–∏</label>`;
        wrapper.appendChild(cbRow);
      }
      catFieldsContainer.appendChild(wrapper);
    }

    /**************************************************************************
     * AUTOCOMPLETE for BRAND
     **************************************************************************/
    const brandInput = document.getElementById("brand");
    const suggestionsEl = document.getElementById("brandSuggestions");
    let suggestionIndex = -1;
    let currentSuggestions = [];

    brandInput.addEventListener("input", onBrandInput);
    brandInput.addEventListener("keydown", onBrandKeyDown);
    brandInput.addEventListener("blur", ()=> setTimeout(()=> suggestionsEl.style.display='none', 150) );

    function onBrandInput(e){
      const val = e.target.value.trim().toLowerCase();
      if (!val){ suggestionsEl.style.display='none'; currentSuggestions=[]; suggestionIndex=-1; return; }
      // —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ (case-insensitive, —à—É–∫–∞—î–º–æ –ø—ñ–¥—Ä—è–¥–æ–∫)
      currentSuggestions = BRANDS.filter(b => b.toLowerCase().includes(val));
      // —Å–æ—Ä—Ç—É—î–º–æ —Ç–∞–∫, —â–æ–± —Ç—ñ —â–æ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –≤–≤–µ–¥–µ–Ω–æ–≥–æ ‚Äî –±—É–ª–∏ –∑–≤–µ—Ä—Ö—É
      currentSuggestions.sort((a,b)=>{
        const av = a.toLowerCase(), bv = b.toLowerCase();
        const startsA = av.startsWith(val), startsB = bv.startsWith(val);
        if (startsA && !startsB) return -1;
        if (!startsA && startsB) return 1;
        return a.localeCompare(b);
      });
      renderBrandSuggestions();
    }

    function renderBrandSuggestions(){
      suggestionsEl.innerHTML = "";
      if (!currentSuggestions.length){ suggestionsEl.style.display='none'; return; }
      currentSuggestions.forEach((s, i)=>{
        const div = document.createElement("div");
        div.className = "suggestion";
        div.textContent = s;
        if (i === suggestionIndex) div.classList.add("active");
        div.addEventListener("mousedown", (ev)=>{
          // mousedown –∑–∞–º—ñ—Å—Ç—å click ‚Äî —â–æ–± –Ω–µ –≤—Ç—Ä–∞—Ç–∏—Ç–∏ —Ñ–æ–∫—É—Å –¥–æ blur
          brandInput.value = s;
          suggestionsEl.style.display = "none";
          suggestionIndex = -1;
        });
        suggestionsEl.appendChild(div);
      });
      suggestionsEl.style.display = "block";
    }

    function onBrandKeyDown(e){
      if (suggestionsEl.style.display === "none") return;
      if (e.key === "ArrowDown"){
        e.preventDefault();
        suggestionIndex = Math.min(suggestionIndex+1, currentSuggestions.length-1);
        renderBrandSuggestions();
      } else if (e.key === "ArrowUp"){
        e.preventDefault();
        suggestionIndex = Math.max(suggestionIndex-1, 0);
        renderBrandSuggestions();
      } else if (e.key === "Enter"){
        e.preventDefault();
        if (suggestionIndex >= 0 && currentSuggestions[suggestionIndex]){
          brandInput.value = currentSuggestions[suggestionIndex];
          suggestionsEl.style.display = "none";
          suggestionIndex = -1;
        }
      } else if (e.key === "Escape"){
        suggestionsEl.style.display = "none";
        suggestionIndex = -1;
      }
    }

    /**************************************************************************
     * AUTOSIZE textarea helper
     **************************************************************************/
    function autosizeTextarea(el){
      if (!el) return;
      el.style.height = "auto";
      const sh = el.scrollHeight;
      el.style.height = Math.max(160, sh) + "px";
    }

    // –∞–≤—Ç–æ–ø—ñ–¥–≥–æ–Ω–∫–∞ —Å—Ç–∞—Ä—Ç–æ–≤–∞
    autosizeTextarea(document.getElementById("output"));
    document.getElementById("output").addEventListener("input", e => autosizeTextarea(e.target));

    /**************************************************************************
     * BUILD result text
     **************************************************************************/
    function buildResultText(){
      const price = document.getElementById("price").value.trim();
      const brand = document.getElementById("brand").value.trim();
      const desc = document.getElementById("descInput").value.trim();
      const condition = (document.querySelector('input[name="condition"]:checked') || {}).value || "";
      const sizes = Array.from(document.querySelectorAll('.size-group input:checked')).map(i=>i.value);
      let text = "";
      if (price) text += `üí∏–¶—ñ–Ω–∞ ${price}\n`;
      if (brand) text += `${brand}\n`;
      if (desc) text += `${desc}\n`;
      if (condition) text += `${condition}\n`;
      text += "‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n";
      if (sizes.length) text += `—Ä–æ–∑–º—ñ—Ä ${sizes.join("/")}\n`;

      // category-specific fields
      if (activeCategory){
        const inputs = [...document.querySelectorAll('#categoryFieldsContainer input[data-field]')];
        inputs.forEach(inp=>{
          if (inp.value.trim()){
            text += `${inp.dataset.field} ${inp.value.trim()}\n`;
          }
        });
        // if fromNeck checked, replace first occurrence of '—Ä—É–∫–∞–≤ ' into '—Ä—É–∫–∞–≤ –≤—ñ–¥ –≥–æ—Ä–ª–æ–≤–∏–Ω–∏ '
        const fromNeck = document.getElementById("fromNeck");
        if (fromNeck && fromNeck.checked){
          text = text.replace(/(—Ä—É–∫–∞–≤\s+)/, "—Ä—É–∫–∞–≤ –≤—ñ–¥ –≥–æ—Ä–ª–æ–≤–∏–Ω–∏ ");
        }
      }

      text += "‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n";
      const materials = Array.from(document.querySelectorAll('.materials input:checked')).map(i=>i.value);
      const customMat = document.getElementById("materialCustom").value.trim();
      if (customMat) materials.push(customMat);
      if (materials.length) text += materials.join("/") + "\n";

      return text.trim();
    }

    function onGenerate(){
      const out = document.getElementById("output");
      out.value = buildResultText();
      autosizeTextarea(out);
    }

    function copyMain(){
      const out = document.getElementById("output");
      if (!out.value) return;
      copyToClipboard(out.value);
    }

    function copyToClipboard(text){
      if (!text) return;
      if (navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).catch(()=> fallbackCopy(text));
      } else fallbackCopy(text);
    }
    function fallbackCopy(text){
      const ta = document.createElement("textarea"); ta.value = text; document.body.appendChild(ta); ta.select();
      try { document.execCommand("copy"); } catch(e){}
      ta.remove();
    }

    /**************************************************************************
     * SAVE (–¥–æ–¥–∞–≤–∞–Ω–Ω—è –∞–∫–æ—Ä–¥–µ–æ–Ω—É —É —Å–ø–∏—Å–æ–∫)
     **************************************************************************/
    function onSave(){
      const text = buildResultText();
      if (!text.trim()) return alert("–ù–µ–º–∞—î —Ç–µ–∫—Å—Ç—É –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.");
      const title = document.getElementById("descInput").value.trim() || "–ë–µ–∑ –Ω–∞–∑–≤–∏";
      addSavedItem(title, text);
      // –æ—á–∏—Å—Ç–∏–º–æ —ñ–Ω–ø—É—Ç–∏, –∞–ª–µ –∑–±–µ—Ä–µ–∂–µ–º–æ —Å–ø–∏—Å–æ–∫
      clearFormInputsKeepingSaved();
    }

    function addSavedItem(title, text){
      const list = document.getElementById("savedList");
      const item = document.createElement("div"); item.className = "saved-item";
      const header = document.createElement("div"); header.className = "saved-header";
      const titleEl = document.createElement("div"); titleEl.className = "saved-title"; titleEl.textContent = title;
      const controls = document.createElement("div"); controls.className = "saved-controls";

      // COPY button (clipboard)
      const copyBtn = document.createElement("button"); copyBtn.className = "icon-btn"; copyBtn.title = "–ö–æ–ø—ñ—é–≤–∞—Ç–∏";
      copyBtn.innerHTML = `<svg viewBox="0 0 24 24"><path d="M16 1H4a1 1 0 0 0-1 1v14h2V3h11V1zm3 4H8a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1zm-1 16H9V7h9v14z"/></svg>`;

      // DELETE button - —Ç—É—Ç –≤—Å—Ç–∞–≤–ª—è—î–º–æ —Ç–≤—ñ–π SVG "–•" (DELETE_SVG –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞)
      const delBtn = document.createElement("button"); delBtn.className = "icon-btn"; delBtn.title = "–í–∏–¥–∞–ª–∏—Ç–∏";
      delBtn.innerHTML = DELETE_SVG;

      controls.appendChild(copyBtn);
      controls.appendChild(delBtn);

      header.appendChild(titleEl);
      header.appendChild(controls);

      const body = document.createElement("div"); body.className = "saved-body"; body.textContent = text;

      // header click toggles body, but ignore clicks on control buttons
      header.addEventListener("click", (ev)=>{
        if (ev.target.closest(".icon-btn")) return;
        const visible = body.style.display === "block";
        body.style.display = visible ? "none" : "block";
      });

      copyBtn.addEventListener("click", (ev)=>{
        ev.stopPropagation();
        copyToClipboard(text);
      });

      delBtn.addEventListener("click", (ev)=>{
        ev.stopPropagation();
        if (confirm("–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –æ–ø–∏—Å?")) item.remove();
      });

      item.appendChild(header);
      item.appendChild(body);
      list.prepend(item);
    }

    /**************************************************************************
     * CLEAR / reset utilities
     **************************************************************************/
    function clearForm(){
      document.querySelectorAll("input[type=text], input[type=number]").forEach(i => i.value = "");
      document.querySelectorAll("input[type=radio], input[type=checkbox]").forEach(i => i.checked = false);
      document.getElementById("categoryFieldsContainer").innerHTML = "";
      document.getElementById("output").value = "";
      autosizeTextarea(document.getElementById("output"));
      [...document.querySelectorAll(".category-pill")].forEach(p => p.classList.remove("active"));
      activeCategory = null;
      // close suggestions
      document.getElementById("brandSuggestions").style.display = "none";
    }

    function clearFormInputsKeepingSaved(){
      document.querySelectorAll("input[type=text], input[type=number]").forEach(i => i.value = "");
      document.querySelectorAll("input[type=radio], input[type=checkbox]").forEach(i => i.checked = false);
      document.getElementById("categoryFieldsContainer").innerHTML = "";
      autosizeTextarea(document.getElementById("output"));
      [...document.querySelectorAll(".category-pill")].forEach(p => p.classList.remove("active"));
      activeCategory = null;
      document.getElementById("brandSuggestions").style.display = "none";
    }

    /**************************************************************************
     * BRAND autocomplete: init suggestions when page loaded to avoid repeated DOM creation
     **************************************************************************/
    // (nothing else needed here; brand input listener handles rendering)

    // keyboard UX nicety: hide suggestions on Escape
    document.addEventListener("keydown", (e)=>{
      if (e.key === "Escape") document.getElementById("brandSuggestions").style.display = "none";
    });

    // ensure textarea autosize on load
    autosizeTextarea(document.getElementById("output"));

    /**************************************************************************
     * –ü–æ–ª–µ–∑–Ω–∏–π fallback: —è–∫—â–æ –∑ —è–∫–∏—Ö–æ—Å—å –ø—Ä–∏—á–∏–Ω splash –Ω–µ —Å—Ö–æ–≤–∞–≤—Å—è (—Å—Ç–∞—Ä—ñ –±—Ä–∞—É–∑–µ—Ä–∏),
     * —á–µ—Ä–µ–∑ 6—Å –≤—Å–µ –æ–¥–Ω–æ –ø—Ä–∏–±–µ—Ä–µ–º–æ –π–æ–≥–æ.
     **************************************************************************/
    setTimeout(()=>{ const s = document.getElementById("splash"); if (s) s.remove(); }, 6000);

  </script>
</body>
</html>
